<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能工作报告助手</title>

    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css" />
    <link rel="stylesheet" href="/static/style.css">

    <!-- 引入 Vue 和组件库 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/element-plus"></script>
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>

    <!-- 引入工具库 -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Element Plus 中文语言包 -->
    <script src="https://unpkg.com/element-plus/dist/locale/zh-cn.min.js"></script>
</head>

<body>
    <div id="app" class="app-container">
        <div class="header">
            <h1>🚀 智能工作报告助手</h1>
            <p>基于大模型自动生成专业日报/周报</p>
        </div>

        <el-row :gutter="20">
            <!-- 左侧：录入表单 -->
            <el-col :span="12" :xs="24">
                <el-card class="box-card">
                    <!-- Tab 切换 -->
                    <el-tabs v-model="activeTab" class="report-tabs">
                        <!-- 日报 Tab -->
                        <el-tab-pane label="📝 日报" name="daily">
                            <div class="tab-header">
                                <span class="tab-title">今日工作记录</span>
                                <el-date-picker 
                                    v-model="form.record_date" 
                                    type="date" 
                                    placeholder="选择日期"
                                    format="YYYY-MM-DD" 
                                    value-format="YYYY-MM-DD" 
                                    :clearable="false" 
                                    size="small"
                                />
                            </div>

                            <el-form :model="form" label-position="top" class="report-form">
                                <el-form-item label="🚀 项目工作 (必填)" required>
                                    <el-input v-model="form.project" type="textarea" :rows="3"
                                        placeholder="例如：完成登录模块开发，对接支付接口..." />
                                </el-form-item>

                                <el-form-item label="📅 次日计划 (必填)" required>
                                    <el-input v-model="form.tomorrow" type="textarea" :rows="2" 
                                        placeholder="例如：继续优化数据库查询..." />
                                </el-form-item>

                                <el-form-item label="🎯 产品工作 (可选)">
                                    <el-input v-model="form.product" type="textarea" :rows="2" 
                                        placeholder="例如：需求评审、用户调研..." />
                                </el-form-item>

                                <el-form-item label="📌 其它工作 (可选)">
                                    <el-input v-model="form.others" type="textarea" :rows="2" 
                                        placeholder="例如：技术分享、学习..." />
                                </el-form-item>

                                <el-form-item label="⚠️ 风险问题 (可选)">
                                    <el-input v-model="form.risks" type="textarea" :rows="2" 
                                        placeholder="例如：性能瓶颈、依赖延期..." />
                                </el-form-item>

                                <el-form-item>
                                    <el-button type="primary" @click="generateDailyReport" :loading="loading" style="width: 100%">
                                        ✨ 保存并生成日报
                                    </el-button>
                                </el-form-item>
                            </el-form>
                        </el-tab-pane>

                        <!-- 周报 Tab -->
                        <el-tab-pane label="📊 周报" name="weekly">
                            <div class="tab-header">
                                <span class="tab-title">选择周报日期范围</span>
                            </div>

                            <el-form label-position="top" class="report-form">
                                <el-form-item label="📆 日期范围">
                                    <el-date-picker
                                        v-model="weeklyForm.dateRange"
                                        type="daterange"
                                        range-separator="至"
                                        start-placeholder="开始日期"
                                        end-placeholder="结束日期"
                                        format="YYYY年MM月DD日"
                                        value-format="YYYY-MM-DD"
                                        :clearable="false"
                                        style="width: 100%"
                                        :shortcuts="dateShortcuts"
                                    />
                                </el-form-item>

                                <el-form-item>
                                    <div class="weekly-info">
                                        <el-alert 
                                            title="周报将汇总所选日期范围内的所有日报记录" 
                                            type="info" 
                                            :closable="false"
                                            show-icon
                                        />
                                    </div>
                                </el-form-item>

                                <el-form-item>
                                    <el-button type="primary" @click="generateWeeklyReport" :loading="loading" style="width: 100%">
                                        ✨ 生成周报
                                    </el-button>
                                </el-form-item>
                            </el-form>
                        </el-tab-pane>
                    </el-tabs>
                </el-card>
            </el-col>

            <!-- 右侧：生成结果 -->
            <el-col :span="12" :xs="24">
                <el-card class="box-card" style="min-height: 600px">
                    <template #header>
                        <div class="card-header">
                            <span>{{ activeTab === 'daily' ? '📋 日报预览' : '📊 周报预览' }}</span>
                            <el-button v-if="generatedReport" type="success" size="small" @click="copyReport">
                                复制内容
                            </el-button>
                        </div>
                    </template>

                    <!-- 使用 v-html 渲染 Markdown -->
                    <div v-if="generatedReport" class="markdown-body" v-html="renderMarkdown(generatedReport)"></div>

                    <el-empty v-else :description="activeTab === 'daily' ? '暂无生成内容，请先在左侧录入并点击生成' : '暂无生成内容，请选择日期范围后点击生成'" />
                </el-card>
            </el-col>
        </el-row>
    </div>

    <!-- 引入逻辑 -->
    <script src="/static/app.js"></script>
</body>

</html>
